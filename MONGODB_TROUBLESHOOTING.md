# Решение проблем с подключением к MongoDB Atlas

## Ошибка: SSL handshake failed

Если вы видите ошибку `SSL handshake failed: TLSV1_ALERT_INTERNAL_ERROR`, попробуйте следующие решения:

### 1. Проверьте доступ по IP в MongoDB Atlas

1. Зайдите в MongoDB Atlas Dashboard
2. Перейдите в **Network Access** (Безопасность → Доступ по IP)
3. Убедитесь что ваш IP адрес добавлен в whitelist
4. Или добавьте `0.0.0.0/0` для доступа отовсюду (только для разработки!)

### 2. Проверьте формат строки подключения

Строка должна выглядеть так:
```
mongodb+srv://username:password@cluster.mongodb.net/dbname?retryWrites=true&w=majority
```

**Важно:**
- Если в пароле есть специальные символы, они должны быть URL-encoded:
  - `@` → `%40`
  - `:` → `%3A`
  - `/` → `%2F`
  - `#` → `%23`
  - `?` → `%3F`
  - `&` → `%26`

### 3. Временное решение (только для тестирования)

Если проблема с SSL сертификатами, можно временно добавить в конец URI:
```
?tlsAllowInvalidCertificates=true
```

**⚠️ ВНИМАНИЕ:** Это небезопасно для production! Используйте только для тестирования.

### 4. Проверьте пользователя базы данных

1. В MongoDB Atlas перейдите в **Database Access**
2. Убедитесь что пользователь существует и имеет права на базу данных
3. Проверьте что пароль правильный

### 5. Обновите библиотеки

```bash
pip install --upgrade pymongo motor
```

### 6. Альтернативный формат подключения

Если `mongodb+srv://` не работает, попробуйте стандартный формат:
```
mongodb://username:password@host1:27017,host2:27017,host3:27017/dbname?ssl=true&replicaSet=atlas-xxxxx-shard-0&authSource=admin
```

Вы можете получить эту строку в MongoDB Atlas:
1. Нажмите **Connect** на вашем кластере
2. Выберите **Connect your application**
3. Выберите **Python** и версию драйвера
4. Скопируйте строку подключения

### Тестирование подключения

Запустите скрипт для диагностики:
```bash
python test_mongodb.py
```

Этот скрипт покажет детальную информацию о проблеме подключения.

